## Homologous Basal Ganglia Network Models in Physiological and Parkinsonian Conditions
Front. Comput. Neurosci., 22 August 2017 | (https://doi.org/10.3389/fncom.2017.00079)

### Abstract
The classical model of basal ganglia has been refined in recent years with discoveries of subpopulations within a nucleus and previously unknown projections. One such discovery is the presence of subpopulations of arkypallidal and prototypical neurons in external globus pallidus, which was previously considered to be a primarily homogeneous nucleus. Developing a computational model of these multiple interconnected nuclei is challenging, because the strengths of the connections are largely unknown. We therefore use a genetic algorithm to search for the unknown connectivity parameters in a firing rate model. We apply a binary cost function derived from empirical firing rate and phase relationship data for the physiological and Parkinsonian conditions. Our approach generates ensembles of over 1,000 configurations, or homologies, for each condition, with broad distributions for many of the parameter values and overlap between the two conditions. However, the resulting effective weights of connections from or to prototypical and arkypallidal neurons are consistent with the experimental data. We investigate the significance of the weight variability by manipulating the parameters individually and cumulatively, and conclude that the correlation observed between the parameters is necessary for generating the dynamics of the two conditions. We then investigate the response of the networks to a transient cortical stimulus, and demonstrate that networks classified as physiological effectively suppress activity in the internal globus pallidus, and are not susceptible to oscillations, whereas parkinsonian networks show the opposite tendency. Thus, we conclude that the rates and phase relationships observed in the globus pallidus are predictive of experimentally observed higher level dynamical features of the physiological and parkinsonian basal ganglia, and that the multiplicity of solutions generated by our method may well be indicative of a natural diversity in basal ganglia networks. We propose that our approach of generating and analyzing an ensemble of multiple solutions to an underdetermined network model provides greater confidence in its predictions than those derived from a unique solution, and that projecting such homologous networks on a lower dimensional space of sensibly chosen dynamical features gives a better chance than a purely structural analysis at understanding complex pathologies such as Parkinson’s disease.

### Introduction
Our results show that these dynamical features serve as good predictors of the network classification, and indicate that the discovered homologies do not come about merely as a result of lack of constraints used for the parameter search, but reflect common non-trivial dynamic properties. We conclude that the generation of large ensembles of valid network configurations based on simple dynamical features (such as rate and phase) and investigating their collective behavior with respect to higher level features (such as oscillation) is a fruitful method for acquiring insight into under-specified neural circuits, and gives a better chance at understanding complex pathologies like Parkinson's disease, which involves alterations to multiple pathways in the basal ganglia.

### 2.1 Mean field model of the basal ganglia
The code for this model and analysis scripts are shared in the [git repository](https://github.com/jyotikab/Homology_BG.git).

### 4.1. Limitations
The model used here is a firing rate model, which is a highly simplified formulation that captures solely the evolution of the
mean activity of a population. This kind of model inherently limits the insights that can be gained about the dynamics of
the system, for example it can give no information about the structure of individual spike trains or higher order correlations
within a population. However, it has the advantage of being computationally less expensive and with a restricted parameter
space with respect to higher resolution simulation methods (e.g., spiking neuronal networks). It should be noted, that an another
modeling work has described a spiking neural network model of the basal ganglia by including the GPe-TA/TI subpopulations
(Lindahl and Hellgren Kotaleski, 2016).

### SUPPLEMENTARY MATERIAL
The Supplementary Material for this article can be found
online [here](http://journal.frontiersin.org/article/10.3389/fncom.2017.00079/full#supplementary-material).

__Supplementary Figure 1__ | Physiological and Parkinsonian weight distributions for three different random seeds.

__Supplementary Figure 2__ | Firing rate distributions of physiological and
parkinsonian homologies during cortical SWA and Beta input conditions. The
histograms for each nuclei was calculated by pooling the activity (shown in
__Figure 3__) across all parkinsonian and physiological networks.

__Supplementary Figure 3__ | Parameters distributions when JD2,FSI was increased by a factor 2.5 for parkinsonian networks. __(A–C)__ same as __Figures 4A–C__.

__Supplementary Figure 4__ | Parameters distributions when JSTN,TA was fixed to zero. __(A–C)__ same as __Figures 4A–C__.

__Supplementary Figure 5__ | Parameter distributions when connections from D1 to GPe-TA/TI are included as free parameters in the genetic algorithm. __(A–C)__ same as __Figures 4A–C__.

__Supplementary Figure 6__ | Parameter distributions when GPi suppression (GS) and Susceptibility to oscillations (SO) are used as constraints. (A–C) same as Figures 4A–C.

__Supplementary Figure 7__ | Firing rates and phase relationships for valid and invalid networks when constrained using GS and SO. Gray lines: invalid networks. Cyan lines: Valid networks for GPe-TA. Green lines: Valid networks for GPe-TI. Compare with __Figure 2__.

###code

In `analysisFFT.py` a comment gives the numpy version as `1.7.2`, which goes back to the date of 2013-12-31. This means a python `2` (ish) release which increases the difficulty of using this code. It may be necessary to convert to Python `3`.

```python
fftfreq = np.fft.fftfreq(int(len(ipctx1["ip"][0])/dt))[:(int(len(ipctx1["ip"][0])/dt))/2] # Had to calculate on local machine, since this version of numpy (1.7.2) doesnt have np.fft.rfftfreq
```
I can find no conditional,
```python
if __name__ == "__main__":
  ```
which indicates a program run from the shell. This means the `py` files were likely run from the ipython shell. This isn't really an issue since we were going to use colab in any case, except colab is moving away from python `2`. If we want our code to be repeatable it will have to be translated to python `3`.

In any case, [stackoverflow](https://stackoverflow.com/questions/61475248/how-can-i-use-python-2-on-google-colab) has a temporary work-around where we could try the python `2` code to see if it's usable for what we need, then use the working `2` version to create the `3` version.


